# Node.js React í”„ë¡œì íŠ¸ í…œí”Œë¦¿ ì˜ˆì‹œ
# npm install ìë™ ì‹¤í–‰ + ê°œë°œ ì„œë²„ ìë™ ì‹œì‘
apiVersion: kubedev.my-project.com/v1alpha1
kind: KubeDevEnvironment
metadata:
  name: nodejs-react-template
  namespace: kubdev-users
spec:
  userName: "example-student"

  # Git ë ˆí¬ì§€í† ë¦¬
  gitRepository: "https://github.com/rosaze/kubdev-auto-system.git"
  gitRef: "main"

  # Docker ì´ë¯¸ì§€ (Node.js + code-server)
  image: "codercom/code-server:latest"

  # ìë™ ì‹¤í–‰ ëª…ë ¹ì–´
  commands:
    # ì´ˆê¸°í™”: npm íŒ¨í‚¤ì§€ ì„¤ì¹˜
    init: |
      echo "ğŸ“¦ Installing npm packages..."
      cd /workspace
      if [ -f "package.json" ]; then
        npm install
        echo "âœ… npm install completed!"
      else
        echo "âš ï¸ No package.json found"
      fi

    # ì‹œì‘: React ê°œë°œ ì„œë²„ ì‹¤í–‰
    start: |
      cd /workspace
      if [ -f "package.json" ]; then
        echo "ğŸš€ Starting development server..."
        npm start
      fi

  # í¬íŠ¸ ë…¸ì¶œ (React ê°œë°œ ì„œë²„: 3000)
  ports:
    - 3000

  # ìŠ¤í† ë¦¬ì§€ í¬ê¸°
  storage:
    size: "15Gi"
