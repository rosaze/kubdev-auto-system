# Python ë°ì´í„° ê³¼í•™ í”„ë¡œì íŠ¸ í…œí”Œë¦¿ ì˜ˆì‹œ
# ë¼ì´ë¸ŒëŸ¬ë¦¬ ìë™ ì„¤ì¹˜ + Flask ì•± ìë™ ì‹¤í–‰
apiVersion: kubedev.my-project.com/v1alpha1
kind: KubeDevEnvironment
metadata:
  name: python-datascience-template
  namespace: kubdev-users
spec:
  userName: "example-student"

  # Git ë ˆí¬ì§€í† ë¦¬
  gitRepository: "https://github.com/APPS-sookmyung/2025-1-AI-Study.git"
  gitRef: "main"

  # Docker ì´ë¯¸ì§€ (Python + code-server)
  image: "codercom/code-server:latest"

  # ìë™ ì‹¤í–‰ ëª…ë ¹ì–´
  commands:
    # ì´ˆê¸°í™”: ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜
    init: |
      echo "ğŸ“¦ Installing Python libraries..."
      cd /workspace
      pip install --upgrade pip
      pip install numpy pandas matplotlib scikit-learn jupyter
      pip install flask requests beautifulsoup4
      echo "âœ… Libraries installed successfully!"

    # ì‹œì‘: Flask ì•± ì‹¤í–‰ (ì„ íƒì‚¬í•­)
    start: |
      cd /workspace
      if [ -f "app.py" ]; then
        echo "ğŸš€ Starting Flask app..."
        python app.py
      else
        echo "â„¹ï¸ No app.py found, skipping auto-start"
      fi

  # í¬íŠ¸ ë…¸ì¶œ (Flask: 5000, Jupyter: 8888 ë“±)
  ports:
    - 5000
    - 8888

  # ìŠ¤í† ë¦¬ì§€ í¬ê¸°
  storage:
    size: "20Gi"
